# devops-netology

Фкирдымов Тимур комментарий к заданию 3.2

***1.Какого типа команда cd? Попробуйте объяснить, почему она именно такого типа; опишите ход своих мыслей, если считаете что она могла бы быть другого типа.***  
CD – встроенная команда bash. Меняет папку только для оболочки, в которой выполняется. Такого типа, потому что меняет текущий рабочий каталог, если бы она была внешней, непонятно как и какой каталог бы менялся в зависимости от процесса.  

***2.Какая альтернатива без pipe команде grep <some_string> <some_file> | wc -l? man grep поможет в ответе на этот вопрос. Ознакомьтесь с документом о других подобных некорректных вариантах использования pipe.***  
$grep <some_string> <some_file>  –c  
Например: grep 123 test_file –c  

***3.Какой процесс с PID 1 является родителем для всех процессов в вашей виртуальной машине Ubuntu 20.04?***  
Выполняю команду pstree –p  
Процесс родитель с PID 1- system  

***4.Как будет выглядеть команда, которая перенаправит вывод stderr ls на другую сессию терминала?***  
Запускаю два окна терминала и вхожу.  
Команда в первом окне - ls -l \test 2>/dev/pts/1  

***5.Получится ли одновременно передать команде файл на stdin и вывести ее stdout в другой файл? Приведите работающий пример.***  
Создал файл test_file и добавил строки:  
Hello  
123  
456  
789  
Bye  

$cat test_file   #смотрю, что в файле  
Hello  
123  
456  
789  
Bye  
$ cat test_out    
cat: test_out: No such file or directory   #проверяю, что такого файла нет  
$ cat <test_file >test_out   #передаю test_file на stdin и вывожу stdout в test_out   
$ cat test_out #проверяю  
Hello  
123  
456  
789  
Bye  

***6.Получится ли находясь в графическом режиме, вывести данные из PTY в какой-либо из эмуляторов TTY? Сможете ли вы наблюдать выводимые данные?***  
Получится, используя перенаправление. Сможем, переключившись между TTY (Ctrl+Alt+FN) или командой chvt.  

***7.Выполните команду bash 5>&1. К чему она приведет? Что будет, если вы выполните echo netology > /proc/$$/fd/5? Почему так происходит?***  
Команда bash 5>&1 приведет к тому, что создастся промежуточный дескриптор и результат с направленный в файл с дескриптором 5 направится в файл с дескриптором 1(stdout).  
Если выполним echo netology > /proc/$$/fd/5 после bash 5>&1 , то увидим вывод netelogy.  
Если выполним echo netology > /proc/$$/fd/5 до команды bash 5>&1 , то увидим ошибку, т.к. дескриптора с таким номером ещё нет.  

***8.Получится ли в качестве входного потока для pipe использовать только stderr команды, не потеряв при этом отображение stdout на pty? Напоминаем: по умолчанию через pipe передается только stdout команды слева от | на stdin команды справа. Это можно сделать, поменяв стандартные потоки местами через промежуточный новый дескриптор, который вы научились создавать в предыдущем вопросе.***  
Получится.  
$ cat test123 #проверяем вывод файла, которого нет.  
cat: test123: No such file or directory  
$ cat test_file  #проверяем вывод существующего файла  
Hello  
123  
456  
789  
Bye  
$ ls -l && cat test123 -z 4>&1 1>&2 2>&4 | wc –l      
#ls – рабочая команда cat – выдаст ошибку.   
#4>&1  пром. дескриптор перенаправили в stdout  
#1>&2   stdout в stderr  
#2>&4  stderr в пром. дескриптор   
drwxrwxr-x 2 vagrant vagrant 4096 Nov 29 09:51 test  
-rw-rw-r-- 1 vagrant vagrant   22 Nov 29 09:42 test_file  
2  
Команда ls сработала, команда cat вернула ошибку.  

***9.Что выведет команда cat /proc/$$/environ? Как еще можно получить аналогичный по содержанию вывод?***  
Команда выводит переменные окружения.  
Аналогичный вывод можно получить командой env  

***10.Используя man, опишите что доступно по адресам*** /proc/<PID>/cmdline, /proc/<PID>/exe
/proc/<PID>/cmdline – содержит полный путь для файла процесса  
/proc/<PID>/exe  - символическая ссылка, содержащая фактический путь к выполняемой команде  

***11.Узнайте, какую наиболее старшую версию набора инструкций SSE поддерживает ваш процессор с помощью /proc/cpuinfo***   
Используя команду cat /proc/cpuinfo | grep sse  вижу, последняя версия 4.2.  

***12.При открытии нового окна терминала и vagrant ssh создается новая сессия и выделяется pty. Это можно подтвердить командой tty, которая упоминалась в лекции 3.2. Однако …. Почитайте, почему так происходит, и как изменить поведение.***  
Это происходит, потому что, когда запускаем команду на удаленном компьютере с помощью ssh, TTY не выделяется для удаленного сеанса.  
Для выполнения нужно добавить –t     $ ssh -t localhost 'tty'   для выделения удаленного TTY  

***13.Бывает, что есть необходимость переместить запущенный процесс из одной сессии в другую. Попробуйте сделать это, воспользовавшись reptyr. Например, так можно перенести в screen процесс, который вы запустили по ошибке в обычной SSH-сессии.***  
Попробовал, были проблемы, но мануал одноклубника помог.  

***14.sudo echo string > /root/new_file не даст выполнить перенаправление под обычным пользователем, так как перенаправлением занимается процесс shell'а, который запущен без sudo под вашим пользователем. Для решения данной проблемы можно использовать конструкцию echo string | sudo tee /root/new_file. Узнайте что делает команда tee и почему в отличие от sudo echo команда с sudo tee будет работать.***  
Команда tee читает из стандартного ввода и записывает как в стандартный вывод, так и в один или несколько файлов одновременно.  
В отличие от sudo echo, sudo tee имея права на запись в файл, запишет в файл и сделает вывод echo через pipe.  


