# devops-netology

Здравствуйте, Фкирдымов Тимур комментарий к заданию 3.7


***1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?***  
$ ip -c -br link  
lo               UNKNOWN        00:00:00:00:00:00 <LOOPBACK,UP,LOWER_UP>  
eth0             UP             08:00:27:73:60:cf <BROADCAST,MULTICAST,UP,LOWER_UP>

Альтернативные команды:
ifconfig –a  
ls /sys/class/net   
netstat –i

***2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?***  
Используется протокол LLDP.  
Пакет используется lldpd.  
Команда: lldpctl или lldpcli show neighbors  
$ lldpctl  
LLDP neighbors:  
-------------------------------------------------------------------------------  
Interface:    eth0, via: LLDP, RID: 1, Time: 0 day, 00:04:04  
  Chassis:  
    ChassisID:    mac b8:d4:e7:39:6b:3c  
    SysDescr:     HPE OfficeConnect Switch 1920S 48G 4SFP PPoE+ (370W) JL386A, PD.02.16, Linux 3.6.5-375bd0e8, U-Boot 2012.10-00118-g3773021 (Oct 11 2016 - 15:39:54)  
    MgmtIP:       192.168.55.31  
    Capability:   Bridge, on  
    Capability:   Router, offPort:  
    PortID:       mac b8:d4:e7:39:6b:3e  
    PortDescr:    46  
    TTL:          120

***3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.***  
Используется VLAN.  
Пакет называется также – vlan  
Команды:  
- редактирование файла /etc/network/interfaces  
- добавление через vconfig (после перезагрузки будет удален)  
- добавление через команду ip (после перезагрузки будет удален)  
Вариант через редактирование файла:  
$ nano /etc/network/interfaces  
auto vlan123                                    # автоматически запускаем интерфейс при запуске службы  
iface vlan123 inet static			# название интерфейса  
address 192.168.4.150  
netmask 255.255.255.0  
vlan-raw-device eth0			        # на каком физическом интерфейсе создаем VLAN  
$ systemctl restart network

***4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.***   
В Linux объединение реализуется с помощью утилиты ifenslave, а работает с помощью модуля ядра "bonding".  
Типы агрегации:  
mode=0 (balance-rr) – пакеты по очереди направляются на сетевые порты объединенного интерфейса.  
mode=1 (active-backup) – активен основной интерфейс, остальные включаются только в случае отказа.  
mode=2 (balance-xor) - объединенный интерфейс определяет, через какую сетевую карту отправить пакеты, в зависимости от MAC-адресов источника и получателя.  
mode=3 (broadcast) - широковещательный режим, все пакеты отправляются через каждый интерфейс.  
mode=4 (802.3ad) – специфичный вариант. Реализует стандарты объединения каналов IEEE и обеспечивает как увеличение пропускной способности, так и отказоустойчивость.  
mode=5 (balance-tlb) - распределение нагрузки при передаче. Входящий трафик обрабатывается в обычном режиме, а при передаче интерфейс определяется на основе данных о загруженности.  
mode=6 (balance-alb) - адаптивное распределение нагрузки. Аналогично предыдущему режиму, но с возможностью балансировать также входящую нагрузку.

Можно реализовать через команду, но работать будет до перезагрузки:  
$ sudo ip link add bond0 type bond mode balance-rr  
$ sudo ip link set eth0 master bond0  
$ sudo ip link set eth1 master bond0

Чтобы работало и после перезагрузки, редактируем файл /etc/network/interfaces  
$ sudo nano /etc/network/interfaces  
	auto bond0				#автоматически запускаем интерфейс при запуске службы    
	iface bond0 inet static			# название интерфейса  
 	address 192.168.4.150			# ip адрес интерфейса  
        netmask 255.255.255.0    		# маска интерфейса  
 	gateway 192.168.4.1			# шлюз интерфейса  
 	dns-nameservers 192.168.4.1 		# DNS сервер  
 	slaves eth0 eth1			# Название физических интерфейсов, которые объединяем  
       	bond_mode 0 #или словам balance-rr	# Режим работы объединенного интерфейса  
        bond-miimon 100				# интервал проверки канала в миллисекундах  
        bond_downdelay 200			# Задержка перед установкой соединения в миллисекундах  
        bound_updelay 200			# Задержка перед обрывом соединения в миллисекундах

$ sudo systemctl restart networking.service   #перезапускаем сетевую службу


***5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.***

В сети с маской /29 – всего 8 IP - адресов, доступных для хостов 6.  
Маска сети /29 = 255.255.255.248.   248 = 11111000 = 2^5 = 32.  
Из сети с маской /24 можно получить – 32 подсети с маской /29.  
Примеры:  
10.10.10.0-10.10.10.7  (10.10.10.0 адрес подсети, 10.10.10.7 широковещательный адрес, 10.10.10.1-10.10.10.6 можно использовать под адреса узлов)  
10.10.10.8-10.10.10.15  
10.10.10.16-10.10.10.23  
…..  
10.10.10.248-10.10.10.255

***6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.***  
Может взять адреса из 100.64.0.0 подсети. Например -  10.64.1.0/26 , максимум 62 узла.

***7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?***  

Проверить можно командой arp –a  
Очистить полностью командой - sudo ip neigh flush all  
Удалить нужный адрес командой - arp –d  
Пример:  
$ arp –a  
(192.168.55.27) at a0:ce:c8:da:2b:46 [ether] on eth0  
_gateway (192.168.55.1) at 00:15:5d:a2:d1:08 [ether] on eth0  
? (192.168.55.199) at b4:2e:99:4c:3d:79 [ether] on eth0  
? (192.168.55.46) at 00:e0:4c:38:b5:45 [ether] on eth0  
? (192.168.55.7) at 00:15:5d:a2:d1:06 [ether] on eth0  
$ sudo arp –d 192.168.55.7  
(192.168.55.27) at a0:ce:c8:da:2b:46 [ether] on eth0  
_gateway (192.168.55.1) at 00:15:5d:a2:d1:08 [ether] on eth0  
? (192.168.55.199) at b4:2e:99:4c:3d:79 [ether] on eth0  
? (192.168.55.46) at 00:e0:4c:38:b5:45 [ether] on eth0  
$ sudo ip neigh flush all
